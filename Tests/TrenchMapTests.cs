using Microsoft.VisualStudio.TestTools.UnitTesting;
using System.IO;

namespace AdventOfCode2021.TrenchMap.Tests;

[TestClass]
public class TrenchMapTests
{
    [TestMethod]
    [DataRow("..#.#..#####.#.#.#.###.##.....###.##.#..###.####..#####..#....#..#..##..###..######.###...####..#..#####..##..#.#####...##.#.#..#.##..#.#......#.###.######.###.####...#.##.##..#..#..#####.....#.#....###..#.##......#.....#..#..#..##..#...##.######.####.####.#.#...#.......#..#.#.#...####.##.#......#..#...##.#.##..#...##.#.##..###.#......#.#.......#.#.#.####.###.##...#.....####.#..#..#.##.#....##..#.####....##...##..#...#......#.#.......#.......##..####..#...#.#.#...##..#.#..###..#####........#..####......#..#\r\n\r\n#..#.\r\n#....\r\n##..#\r\n..#..\r\n..###", 0, "#..#.\r\n#....\r\n##..#\r\n..#..\r\n..###\r\n", 10)]
    [DataRow("..#.#..#####.#.#.#.###.##.....###.##.#..###.####..#####..#....#..#..##..###..######.###...####..#..#####..##..#.#####...##.#.#..#.##..#.#......#.###.######.###.####...#.##.##..#..#..#####.....#.#....###..#.##......#.....#..#..#..##..#...##.######.####.####.#.#...#.......#..#.#.#...####.##.#......#..#...##.#.##..#...##.#.##..###.#......#.#.......#.#.#.####.###.##...#.....####.#..#..#.##.#....##..#.####....##...##..#...#......#.#.......#.......##..####..#...#.#.#...##..#.#..###..#####........#..####......#..#\r\n\r\n#..#.\r\n#....\r\n##..#\r\n..#..\r\n..###", 1, ".##.##.\r\n#..#.#.\r\n##.#..#\r\n####..#\r\n.#..##.\r\n..##..#\r\n...#.#.\r\n", 24)]
    [DataRow("..#.#..#####.#.#.#.###.##.....###.##.#..###.####..#####..#....#..#..##..###..######.###...####..#..#####..##..#.#####...##.#.#..#.##..#.#......#.###.######.###.####...#.##.##..#..#..#####.....#.#....###..#.##......#.....#..#..#..##..#...##.######.####.####.#.#...#.......#..#.#.#...####.##.#......#..#...##.#.##..#...##.#.##..###.#......#.#.......#.#.#.####.###.##...#.....####.#..#..#.##.#....##..#.####....##...##..#...#......#.#.......#.......##..####..#...#.#.#...##..#.#..###..#####........#..####......#..#\r\n\r\n#..#.\r\n#....\r\n##..#\r\n..#..\r\n..###", 2, ".......#.\r\n.#..#.#..\r\n#.#...###\r\n#...##.#.\r\n#.....#.#\r\n.#.#####.\r\n..#.#####\r\n...##.##.\r\n....###..\r\n", 35)]
    public void GetEnhancedImage_Always_ReturnsExpectedResult(string input, int enhancementCount, string expectedOutput, int expectedResult)
    {
        // Arrange
        var reader = new StringReader(input);
        var trenchMap = new TrenchMap(reader);

        // Act
        TrenchMap.Image result = trenchMap.GetEnhancedImage(enhancementCount);

        // Assert
        Assert.AreEqual(expectedOutput, result.ToString());
        Assert.AreEqual(expectedResult, result.GetLitPixelCount());
    }
}
